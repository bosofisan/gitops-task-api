apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
  - ../../base

namespace: task-api-staging

namePrefix: staging-

commonLabels:
  environment: staging
  version: "1.0.0"

commonAnnotations:
  environment: staging
  description: "Task API - Staging Environment"

replicas:
  - name: staging-task-api-deployment
    count: 2

images:
  - name: task-api
    newTag: v1
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/resources
        value:
          requests:
            memory: "128Mi"
            cpu: "100m"
          limits:
            memory: "256Mi"
            cpu: "200m"
  - target:
      kind: Service
      name: staging-task-api-service
    patch: |-
      - op: replace
        path: /spec/type
        value: ClusterIP

env:
  - name: ENVIRONMENT
    value: staging
  - name: LOG_LEVEL
    value: INFO
